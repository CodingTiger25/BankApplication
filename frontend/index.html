<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Main Page</title>
    <link href="css/style.css" rel="stylesheet">
</head>

    <body>
    <script>
        function getUserName(){
            let user = document.getElementById("nameField").value;
            let pass = document.getElementById("passField").value;

            var obj;

            fetch('http://localhost:8080/login', {
                method: 'POST',
                headers: {
                    accept: 'application/json',
                    'Content-Type': 'application/json',
                    'Access-Control-Allow-Origin': '*',
                    'Access-Control-Allow-Credentials': true
                },

                redirect:"follow",

                referrerPolicy:"no-referrer",

                body: JSON.stringify({
                    "userName": user,
                    "password": pass,
                })
            })

                .then(res => res.text())
                .then(data => {
                    obj = data;
                    console.log(obj);
                })
                .then(() => {
                    sessionStorage.setItem('token', obj);
                    window.location.replace("pages/home-page.html");
                });


                /*.then(res => {
                    console.log(res);
                    localStorage.setItem('Bearer', res.text();
                    let token = localStorage.getItem('Bearer');
                    console.log(token)
                })
                /*.then(res => console.log('RES: ' + res.data()))

                let data = localStorage.getItem('Bearer');
                console.log('THIS IS BASE: ' + data);
                //.then(res => console.log(res))

           // window.location.replace("pages/home-page.html") ;*/
        }
    </script>

    <script type="text/javascript">
        function registration(){


            window.location.replace("pages/register.html");
        }

    </script>
    <header class="bank-title">
        <h1>
            Bank Login Page
        </h1>
    </header>
    <main class="login">
        <form  method="post">
            <div >
                <label id="username" for="nameField">Username: </label>
                <input id = "nameField" type="text"/>


                <label id="password" for="passField">Password: </label>
                <input id = "passField" type="text"/>
            </div>

            <div>
                <button type="button" onclick=" return getUserName()">
                    Login
                </button>
            </div>
        </form>

        <div>
             <button id="registerPage" onclick="registration()"> Register</button>
        </div>
    </main>

    </body>
</html>